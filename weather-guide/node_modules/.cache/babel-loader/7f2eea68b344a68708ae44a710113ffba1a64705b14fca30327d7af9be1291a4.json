{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nconst APIKEY = '0efd39a5159ec4ff5bd0154841da469a';\nconst useWeather = query => {\n  _s();\n  const [weatherResponse, setWeatherResponse] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(false);\n  useEffect(() => {\n    let ignore = false;\n    const controller = new AbortController();\n    let responseBody = {};\n    async function fetchCity() {\n      setLoading(true);\n      try {\n        const response = await fetch(`http://api.openweathermap.org/geo/1.0/direct?q=${query}&appid=${APIKEY}`, {\n          signal: controller.signal\n        });\n        if (response.status !== 200) {\n          setError(true);\n        } else {\n          setError(false);\n          responseBody = await response.json();\n          fetchWeather(responseBody);\n        }\n      } catch (e) {\n        if (e instanceof DOMException) {\n          console.log(\"canceled by Dom\");\n        } else {\n          setError(true);\n          console.log(e);\n          throw e;\n        }\n      }\n    }\n    async function fetchWeather(r) {\n      try {\n        let lat = r[0].lat;\n        let long = r[0].lon;\n        console.log(long);\n        const res = await fetch(`http://api.openweathermap.org/data/2.5/forecast/daily?lat=${lat}&lon=${long}&cnt=7&appid=${APIKEY}`);\n        if (res.status !== 200) {\n          setError(true);\n        } else {\n          setError(false);\n          responseBody = await res.json();\n          setWeatherResponse(responseBody);\n        }\n      } catch (e) {\n        if (e instanceof DOMException) {\n          console.log(\"canceled by Dom\");\n        } else {\n          setError(true);\n          console.log(e);\n          throw e;\n        }\n      }\n    }\n    if (query !== \"\") {\n      fetchCity();\n    }\n    return () => {\n      ignore = true;\n      controller.abort();\n    };\n  }, [query]);\n  return [weatherResponse, loading, error];\n};\n_s(useWeather, \"td63xymgDkfMCod8/3pv6rycRg8=\");\nexport default useWeather;","map":{"version":3,"names":["useEffect","useState","APIKEY","useWeather","query","_s","weatherResponse","setWeatherResponse","loading","setLoading","error","setError","ignore","controller","AbortController","responseBody","fetchCity","response","fetch","signal","status","json","fetchWeather","e","DOMException","console","log","r","lat","long","lon","res","abort"],"sources":["/Users/bina/github-classroom/osu-cs494-w23/final-project-group-18/weather-guide/src/components/MainPage/WeatherBroadCast/useWeather.js"],"sourcesContent":["import { useEffect, useState } from 'react'\nconst APIKEY = '0efd39a5159ec4ff5bd0154841da469a'\n\nconst useWeather = ((query) =>{\n    const [weatherResponse, setWeatherResponse] = useState([])\n    const [loading, setLoading] = useState(false)\n    const [error, setError] = useState(false)\n\n    useEffect(()=>{\n        let ignore = false\n        const controller = new AbortController()\n        let responseBody = {}\n        async function fetchCity() {\n            setLoading(true)\n            try {\n                const response = await fetch(\n                    `http://api.openweathermap.org/geo/1.0/direct?q=${query}&appid=${APIKEY}`,\n                    { signal: controller.signal }\n                )\n\n                if (response.status !== 200){\n                    setError(true)\n                }else{\n                    setError(false)\n                    responseBody = await response.json()\n                    fetchWeather(responseBody)\n                }\n            } catch (e) {\n                if (e instanceof DOMException) {\n                    console.log(\"canceled by Dom\")\n                } else {\n                    setError(true)\n                    console.log(e)\n                    throw e\n                }\n            }\n        }\n\n        async function fetchWeather(r) {\n            try {\n                let lat = r[0].lat\n                let long = r[0].lon\n                console.log(long)\n                const res = await fetch(\n                    `http://api.openweathermap.org/data/2.5/forecast/daily?lat=${lat}&lon=${long}&cnt=7&appid=${APIKEY}`,\n                )\n\n                if (res.status !== 200){\n                    setError(true)\n                }else{\n                    setError(false)\n                    responseBody = await res.json()\n                    setWeatherResponse(responseBody)\n                }\n            } catch (e) {\n                if (e instanceof DOMException) {\n                    console.log(\"canceled by Dom\")\n                } else {\n                    setError(true)\n                    console.log(e)\n                    throw e\n                }\n            }\n        }\n\n        if (query !== \"\"){\n            fetchCity()\n        }\n\n        return () =>{\n            ignore = true\n            controller.abort()\n        }\n\n\n    }, [query])\n\n\n    return [weatherResponse, loading, error]\n})\n\nexport default useWeather"],"mappings":";AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,MAAMC,MAAM,GAAG,kCAAkC;AAEjD,MAAMC,UAAU,GAAKC,KAAK,IAAI;EAAAC,EAAA;EAC1B,MAAM,CAACC,eAAe,EAAEC,kBAAkB,CAAC,GAAGN,QAAQ,CAAC,EAAE,CAAC;EAC1D,MAAM,CAACO,OAAO,EAAEC,UAAU,CAAC,GAAGR,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACS,KAAK,EAAEC,QAAQ,CAAC,GAAGV,QAAQ,CAAC,KAAK,CAAC;EAEzCD,SAAS,CAAC,MAAI;IACV,IAAIY,MAAM,GAAG,KAAK;IAClB,MAAMC,UAAU,GAAG,IAAIC,eAAe,EAAE;IACxC,IAAIC,YAAY,GAAG,CAAC,CAAC;IACrB,eAAeC,SAASA,CAAA,EAAG;MACvBP,UAAU,CAAC,IAAI,CAAC;MAChB,IAAI;QACA,MAAMQ,QAAQ,GAAG,MAAMC,KAAK,CACvB,kDAAiDd,KAAM,UAASF,MAAO,EAAC,EACzE;UAAEiB,MAAM,EAAEN,UAAU,CAACM;QAAO,CAAC,CAChC;QAED,IAAIF,QAAQ,CAACG,MAAM,KAAK,GAAG,EAAC;UACxBT,QAAQ,CAAC,IAAI,CAAC;QAClB,CAAC,MAAI;UACDA,QAAQ,CAAC,KAAK,CAAC;UACfI,YAAY,GAAG,MAAME,QAAQ,CAACI,IAAI,EAAE;UACpCC,YAAY,CAACP,YAAY,CAAC;QAC9B;MACJ,CAAC,CAAC,OAAOQ,CAAC,EAAE;QACR,IAAIA,CAAC,YAAYC,YAAY,EAAE;UAC3BC,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC;QAClC,CAAC,MAAM;UACHf,QAAQ,CAAC,IAAI,CAAC;UACdc,OAAO,CAACC,GAAG,CAACH,CAAC,CAAC;UACd,MAAMA,CAAC;QACX;MACJ;IACJ;IAEA,eAAeD,YAAYA,CAACK,CAAC,EAAE;MAC3B,IAAI;QACA,IAAIC,GAAG,GAAGD,CAAC,CAAC,CAAC,CAAC,CAACC,GAAG;QAClB,IAAIC,IAAI,GAAGF,CAAC,CAAC,CAAC,CAAC,CAACG,GAAG;QACnBL,OAAO,CAACC,GAAG,CAACG,IAAI,CAAC;QACjB,MAAME,GAAG,GAAG,MAAMb,KAAK,CAClB,6DAA4DU,GAAI,QAAOC,IAAK,gBAAe3B,MAAO,EAAC,CACvG;QAED,IAAI6B,GAAG,CAACX,MAAM,KAAK,GAAG,EAAC;UACnBT,QAAQ,CAAC,IAAI,CAAC;QAClB,CAAC,MAAI;UACDA,QAAQ,CAAC,KAAK,CAAC;UACfI,YAAY,GAAG,MAAMgB,GAAG,CAACV,IAAI,EAAE;UAC/Bd,kBAAkB,CAACQ,YAAY,CAAC;QACpC;MACJ,CAAC,CAAC,OAAOQ,CAAC,EAAE;QACR,IAAIA,CAAC,YAAYC,YAAY,EAAE;UAC3BC,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC;QAClC,CAAC,MAAM;UACHf,QAAQ,CAAC,IAAI,CAAC;UACdc,OAAO,CAACC,GAAG,CAACH,CAAC,CAAC;UACd,MAAMA,CAAC;QACX;MACJ;IACJ;IAEA,IAAInB,KAAK,KAAK,EAAE,EAAC;MACbY,SAAS,EAAE;IACf;IAEA,OAAO,MAAK;MACRJ,MAAM,GAAG,IAAI;MACbC,UAAU,CAACmB,KAAK,EAAE;IACtB,CAAC;EAGL,CAAC,EAAE,CAAC5B,KAAK,CAAC,CAAC;EAGX,OAAO,CAACE,eAAe,EAAEE,OAAO,EAAEE,KAAK,CAAC;AAC5C,CAAE;AAAAL,EAAA,CA5EIF,UAAU;AA8EhB,eAAeA,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}